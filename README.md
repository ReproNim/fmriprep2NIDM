# fmriprep2NIDM
Repo for the process of adding the results of fmriprep processing to the NIDM graph.

This fmriprep2NIDM project is designed to be a specific example of a more generic [csv2NIDM](https://github.com/incf-nidash/PyNIDM?tab=readme-ov-file#csv-file-to-nidm-conversion) problem.

The goal is to 
* Run an analysis tool (such as fmriprep),
* Represent the results of the tool in a CSV file (example [here](CSVs/ABIDE_fmriprep_results_v2.csv))
* Generate a dictionary for the results as a CSV file (example [here](CSVs/fmriprep_data_dictionary_v3.csv))
* Generate a tool description file (as a CSV file) that captures the details of the analysis
   (example [here](CSVs/fmriprep_software_metadata.csv))
* Use the above 3 CSV files as input to *pynidm* to generate either a standalone NIDM representation of the results
  of the analysis tool, or append the tool results to the NIDM representation of the dataset that the tool was applied to.

  ## Example
  ### Step 1: Run fmriprep
  Our friends at **INDI** have run the *fmriprep* tool on much of their publically hosted data, includeing the ABIDS and
  ADHD-200 datasets. These *fmriprep* results are available on the **INDI** AWS S3 bucket. The 'path' for such an
  example fmriprep run for sub-0050118 of the ABIDE dataset is:

  s3://fcp-indi/data/Projects/ABIDE/Outputs/fmriprep/fmriprep/sub-0050118

  There are many example results here.

  ### Step 2: Represent the results of the tool in a CSV file
  Th fmriprep processing generates descriptors of each time point of a fMRI run. For the summary we want to include
  as metadata about the run, we want to generate a summary (i.e. average, standard deviation, etc.) of a select set
  of features from the complete set generated by *fmriprep*.

  We use a tool called *summarize_confounds* (thanks Christian!). It currently lives as a private repository at:
  [summarize_confounds](https://github.com/BabyBrainStudy/SumarizeNibabies), but will soon more to a public
  repository within the ReproNim organization. More retails about how the summarizer works is provided in
  its documentation.

  This tool was used to generate the *ABIDE_fmriprep_results.csv* file shared above, by running it on all the
  ABIDE fmriprep results available at s3://fcp-indi/data/Projects/ABIDE/Outputs/fmriprep.

  
  
